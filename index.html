<script>
  // --- helper: safe getter ---
  const getNAME1 = f => (f && f.properties && f.properties.NAME_1) ? f.properties.NAME_1 : '';

  // --- categorical colors by NAME_1 (tweak as you like) ---
  const regionColors = {
    'Latgale':   '#111111',   // special (outline only + light fill below)
    'Vidzeme':   '#377eb8',
    'Kurzeme':   '#4daf4a',
    'Zemgale':   '#ff7f00',
    'Riga':      '#984ea3'
  };
  const fallbackFill = '#cccccc';

  // --- style function driven by NAME_1 ---
  function polygonStyle(feature) {
    const name1 = getNAME1(feature);

    if (name1 === 'Latgale') {
      // bold outline, faint fill
      return {
        color: '#111111',
        weight: 3,
        fillColor: '#ffffff',
        fillOpacity: 0.15
      };
    }

    // other regions (use palette; fall back if unknown)
    return {
      color: '#222222',
      weight: 1,
      fillColor: regionColors[name1] || fallbackFill,
      fillOpacity: 0.18
    };
  }

  // --- build the layer ---
  let polygonsLayer;
  fetch('Base_map_Latgale.geojson')
    .then(r => r.json())
    .then(data => {
      polygonsLayer = L.geoJSON(data, {
        style: polygonStyle,
        onEachFeature: (feature, layer) => {
          const name1 = getNAME1(feature) || 'Unknown region';
          layer.bindPopup(name1);

          // simple hover emphasis
          layer.on('mouseover', () => layer.setStyle({ weight: (layer.options.weight || 1) + 1 }));
          layer.on('mouseout',  () => polygonsLayer.resetStyle(layer));
        }
      }).addTo(map);

      // zoom to polygons
      try { map.fitBounds(polygonsLayer.getBounds(), { padding: [20, 20] }); } catch (e) {}
    });
</script>
